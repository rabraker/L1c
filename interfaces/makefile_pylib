#
#******************************************************************************

#
# Locating the root directory
#

MKLROOT        = /opt/intel/compilers_and_libraries_2019.1.144/linux/mkl

OPT            = -O3 -march=native -mtune=native
MATH_INCLUDE   =  -I${MKLROOT}/include
MATH_CFLAGS    =  -DMKL_ILP64  -D_USEMKL_  -m64

CFLAGS         =  $(OPT) $(DBG) -fopenmp -fPIC $(WARN_FLAGS) \
					-std=c11 $(MAT_DEF)
CFLAGS        +=   -I../ -I../include $(MATH_INCLUDE) $(MATH_CFLAGS)

MATH_LIBS      = -L${MKLROOT}/lib/intel64 -Wl,--no-as-needed -lmkl_rt -lpthread -lm -ldl \
					-lfftw3 -lgomp


LDFLAGS       += -Wl,--start-group $(MATH_ARCHIVE) \
			../lib/libl1qc.a ../lib/libvcl_math.a -Wl,--end-group \
			$(MATH_LDIR) $(MATH_LIBS)


lib: libl1qc_dct.o
	$(CC)  -shared libl1qc_dct.o -o libl1qc_dct.so $(LDFLAGS)

libl1qc_dct.o:libl1qc_dct.c
	gcc $(CFLAGS) -c -o libl1qc_dct.o libl1qc_dct.c

clean:
	rm libl1qc_dct.so
